<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>闭包经典问题</title>
</head>
<body>
	<script>
		// function box(){
		// 	var arr = new Array();
		// 	for(var i=0;i<5;i++){
		// 		arr[i] = i;

		// 	}
		// 	return arr;
		// }
		
		//循环里面包含闭包函数
		// function box(){
		//     var arr = [];
		//     for(var i=0;i<5;i++){
		//         arr[i] = function(){
		//             return i;
		//              //由于这个闭包的关系，他是循环完毕之后才返回，最终结果是4++是5
		//         } //这个匿名函数里面根本没有i这个变量，所以匿名函数会从父级函数中去找i，
	 //    	}//当找到这个i的时候，for循环已经循环完毕了，所以最终会返回5
	 //    	return arr;
		// }
		// 执行匿名函数本身

		//使用自执行的匿名函数
		//在函数体外面加一对圆括号，形成一个表达式，在圆括号后面再加一个圆括号，里面可传入参数。
		// function box(){
		// 	var arr = new Array();
		// 	for(var i=0;i<5;i++){
		// 		arr[i]=(function(index){
		// 			return index;
		// 		})(i);
		// 	}
		// 	return arr;
		// }
		//如果将一个匿名函数自我执行的时候赋值给一个变量，那么这个匿名函数中的圆括号的可以去掉的
		// function box(){
		// 	var arr = new Array();
		// 	for(var i=0;i<5;i++){
		// 		arr[i]=function(index){
		// 			return index;
		// 		}(i);
		// 	}
		// 	return arr;
		// }

		//或者还是使用自执行匿名函数
		//  function box(){
		// 	var arr = new Array();
		// 	for(var i=0;i<5;i++){
		// 		arr[i]=function(index){
		// 			function f(){ 
		// 				return index;
		// 			}
		// 			return f();
		// 		}(i);
		// 	}
		// 	return arr;
		// }
//		function box(){
//			var arr = new Array();
//			for(var i=0;i<5;i++){
//				arr[i]=function(index){
//					return function(){
//						return index;
//					};
//				}(i);
//			}
//			return arr;
//		}
//		alert(box());

		var x = 1;//x表示的是window.x
		function test() {
		  this.x= 0;
		}

		console.log(x);//1
		test();//此时的this就是window，所以执行过test方法之后，this.x= 0 就表示window.x= 0；他修改了原来的x=1
        console.log((new test()).x)
		console.log(window.x)
		//所以最终的结果为0
		console.log(x);//0
	</script>
</body>
</html>